---
# All variables needed to deploy the tripleo-quickstart-scalelab project.

rhos_release_rpm: "{{ lookup('env', 'RHOS_RELEASE_URL') }}"

# OSP/OSPd versioning and build
version: 11
rhel_version: 7.4
rhos_release: 11-director
build: z4

overcloud_image_password: debug

# bulk introspection
introspection: false

# better introspection, be sure to turn bulk off if you use this
introspect_with_retry: true

# Stack user password. Encrypted with sha512
stack_password: "{{ lookup('env', 'STACK_PASSWORD') }}"

# undercloud control plane interface:
local_interface: enp94s0f1

# option to enable/disable ironic node cleaning on overcloud nodes
node_cleaning: false

external_network_vip: "{{ lookup('env', 'EXTERNAL_NETWORK_VIP') }}"

# External private vlan on undercloud:
public_net_device: eno1
# Deploy a vlan device for the external private network.
deploy_external_private_vlan: "{{ lookup('env', 'DEPLOY_EXTERNAL_PRIVATE_LAN')|default(true, true) }}"
# Do not use Network Address Translation (NAT) to route the traffic to this device.
deploy_external_private_nat: "{{ lookup('env', 'DEPLOY_EXTERNAL_PRIVATE_NAT')|default(false, true) }}"
# The external vlan to use for creating the OpenStack public network.
external_vlan: "{{ lookup('env', 'EXTERNAL_VLAN')|default('620', true) }}"
# The external vlan device name.
external_vlan_device: "enp94s0f3.{{ external_vlan }}"
private_external_address: "{{ lookup('env', 'PRIVATE_EXTERNAL_ADDRESS') }}"
private_external_netmask: "{{ lookup('env', 'PRIVATE_EXTERNAL_NETMASK')|default('255.255.255.192', true) }}"

# Public subnet settings:
subnet_pool_start: "{{ lookup('env', 'SUBNET_POOL_START')|default('10.12.95.203', true) }}"
subnet_pool_end: "{{ lookup('env', 'SUBNET_POOL_END')|default('10.12.95.251', true) }}"
subnet_gateway: "{{ lookup('env', 'SUBNET_GATEWAY')|default('10.12.95.254', true) }}"
subnet_range: "{{ lookup('env', 'SUBNET_RANGE')|default('10.12.95.192/26', true) }}"

# neutron dns:
dns_server: "{{ lookup('env', 'DNS_SERVER') }}"

# instackenv:
instackenv_json: "{{ lookup('env', 'INSTACKENV_JSON') }}"

cloud_title: "{{ lookup('env', 'CLOUD_TITLE') }}"
ticket_number: "{{ lookup('env', 'TICKET_NUMBER') }}"
foreman_url: "{{ lookup('env', 'FOREMAN_URL') }}"
undercloud_hostname: "{{ lookup('env', 'UNDERCLOUD_HOSTNAME') }}"

# 12 total systems - 1 undercloud (RMA) - 1 undercloud - 3 OpenStack controllers - 3 ceph
num_compute: "{{ lookup('env', 'NUM_COMPUTE')|default(4, true) }}"
num_storage: "{{ lookup('env', 'NUM_STORAGE')|default(3, true) }}"

# Must be >= total number of hosts used for undercloud tuning
total_hosts: "{{ num_compute | int + num_storage | int }}"

openstack_deployment_hosts:
  - host_type:
      pin: 1029pcompute # as mapped in roles data under HostnameFormatDefault will have -# appended to lock hosts to machines
      title: P1029Compute # The actual title we use to deploy the role, the name field in roles data
      hint: "1029p" # The hint we look for in the management address string to determine what type of host we're looking at
      count: "{{ num_compute }}"
  - host_type:
      pin: cephstorage
      title: CephStorage
      hint: "1029p"
      count: "{{ num_storage }}" # The number of systems to use for storage.

controller_type: 1029p
num_controllers: "{{ lookup('env', 'NUM_CONTROLLERS')|default(3, true) }}"

ceph_host: 1029p  # There are no 1029u systems for the cloud05 environment.

# Get the time server from the NTP_SERVER environment variable.
ntp_server: "{{ lookup('env', 'NTP_SERVER') }}"

# Metadata storage
graphite_host: "{{ lookup('env', 'GRAPHITE') }}"
# Graphite prefix / Cloud name used both with graphite and grafana dashboards
graphite_prefix: "{{ lookup('env', 'CLOUD_NAME') }}"
